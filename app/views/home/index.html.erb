<script type="text/javascript">
function validate() {
  if ($("#newTxt").val() == "") {
    $("#newTxt").addClass("field_with_errors");
    $("#validationErrors").hide();
    $("#nullErrors").show();
    return false;
  } else {
    create();
    return false;
  }
}
function create() {  
  $.ajax({
    method: "POST",
    url: "new/",
    data: { "name": $("newTxt").val() }
  });
}
function destroy(id) {
  if (confirm("Are you sure you want to delete this sketch?")) {
    $.ajax({
      method: "POST",
      url: "delete/",
      data: { "id": id }
  }
}
</script>
<% if current_user %>
<fieldset><legend>Your Sketches</legend>
<% sketches = current_user.sketches %>
<% if sketches.length > 0 %>
<table>
  <!--<tr>
    <th>Name</th>
    <th></th>
    <th></th>
    <th></th>
  </tr>-->
  <% sketches.each do |sketch| %>
  <tr>
    <td><%= link_to sketch.name, "/edit/#{sketch.id}" %></td>
    <td><%= link_to_function "Delete", "destroy(#{sketch.id})" %></td>
  </tr>
  <% end %>
</table>
<% else %>
<b>No Sketches! Create a new one below to get started.</b>
<% end %>
</fieldset>
<div id="nullErrors" style="display:none;color:red">Please enter a name</div>
<form id="newForm" onsubmit="return validate()">
<fieldset>
<legend>New Sketch</legend>
  <input type="text" id="newTxt" /><input type="submit" value="New Sketch" />
</fieldset>
</form>
<% else %>
Welcome to Sketch Lab! Please <%= link_to "sign in", signin_path %> to see your sketches.
<% end %>
